(function(B){B.gritter={};B.gritter.options={position:"",class_name:"",fade_in_speed:"medium",fade_out_speed:1000,time:6000};B.gritter.add=function(C){try{return A.add(C||{})}catch(E){var D="Gritter Error: "+E;(typeof(console)!="undefined"&&console.error)?console.error(D,C):alert(D)}};B.gritter.remove=function(D,C){A.removeSpecific(D,C||{})};B.gritter.removeAll=function(C){A.stop(C||{})};var A={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<div class="gritter-close"></div>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(G){if(typeof(G)=="string"){G={text:G}}if(G.text===null){throw'You must supply "text" parameter.'}if(!this._is_setup){this._runSetup()}var L=G.title,M=G.text,O=G.image||"",K=G.sticky||false,N=G.class_name||B.gritter.options.class_name,E=B.gritter.options.position,C=G.time||"";this._verifyWrapper();this._item_count++;var H=this._item_count,J=this._tpl_item;B(["before_open","after_open","before_close","after_close"]).each(function(P,Q){A["_"+Q+"_"+H]=(B.isFunction(G[Q]))?G[Q]:function(){}});this._custom_timer=0;if(C){this._custom_timer=C}var F=(O!="")?'<img src="'+O+'" class="gritter-image" />':"",I=(O!="")?"gritter-with-image":"gritter-without-image";if(L){L=this._str_replace("[[title]]",L,this._tpl_title)}else{L=""}J=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[L,M,this._tpl_close,F,this._item_count,I,N],J);if(this["_before_open_"+H]()===false){return false}B("#gritter-notice-wrapper").addClass(E).append(J);var D=B("#gritter-item-"+this._item_count);D.fadeIn(this.fade_in_speed,function(){A["_after_open_"+H](B(this))});if(!K){this._setFadeTimer(D,H)}B(D).bind("mouseenter mouseleave",function(P){if(P.type=="mouseenter"){if(!K){A._restoreItemIfFading(B(this),H)}}else{if(!K){A._setFadeTimer(B(this),H)}}A._hoverState(B(this),P.type)});B(D).find(".gritter-close").click(function(){A.removeSpecific(H,{},null,true)});return H},_countRemoveWrapper:function(C,E,D){E.remove();this["_after_close_"+C](E,D);if(B(".gritter-item-wrapper").length==0){B("#gritter-notice-wrapper").remove()}},_fade:function(I,G,C,E){var C=C||{},F=(typeof(C.fade)!="undefined")?C.fade:true,D=C.speed||this.fade_out_speed,H=E;this["_before_close_"+G](I,H);if(E){I.unbind("mouseenter mouseleave")}if(F){I.animate({opacity:0},D,function(){I.animate({height:0},300,function(){A._countRemoveWrapper(G,I,H)})})}else{this._countRemoveWrapper(G,I)}},_hoverState:function(D,C){if(C=="mouseenter"){D.addClass("hover");D.find(".gritter-close").show()}else{D.removeClass("hover");D.find(".gritter-close").hide()}},removeSpecific:function(E,C,F,D){if(!F){var F=B("#gritter-item-"+E)}this._fade(F,E,C||{},D)},_restoreItemIfFading:function(D,C){clearTimeout(this["_int_id_"+C]);D.stop().css({opacity:"",height:""})},_runSetup:function(){for(opt in B.gritter.options){this[opt]=B.gritter.options[opt]}this._is_setup=1},_setFadeTimer:function(E,C){var D=(this._custom_timer)?this._custom_timer:this.time;this["_int_id_"+C]=setTimeout(function(){A._fade(E,C)},D)},stop:function(C){var E=(B.isFunction(C.before_close))?C.before_close:function(){};var F=(B.isFunction(C.after_close))?C.after_close:function(){};var D=B("#gritter-notice-wrapper");E(D);D.fadeOut(function(){B(this).remove();F()})},_str_replace:function(O,F,N,Q){var C=0,D=0,P="",I="",L=0,H=0,J=[].concat(O),M=[].concat(F),E=N,G=M instanceof Array,K=E instanceof Array;E=[].concat(E);if(Q){this.window[Q]=0}for(C=0,L=E.length;C<L;C++){if(E[C]===""){continue}for(D=0,H=J.length;D<H;D++){P=E[C]+"";I=G?(M[D]!==undefined?M[D]:""):M[0];E[C]=(P).split(J[D]).join(I);if(Q&&E[C]!==P){this.window[Q]+=(P.length-E[C].length)/J[D].length}}}return K?E:E[0]},_verifyWrapper:function(){if(B("#gritter-notice-wrapper").length==0){B("body").append(this._tpl_wrap)}}}})(jQuery);