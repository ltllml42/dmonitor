!function(C){var D=function(E){this.value={h:1,s:1,b:1,a:1};this.setColor(E)};D.prototype={constructor:D,setColor:function(F){F=F.toLowerCase();var E=this;C.each(B.stringParsers,function(I,K){var H=K.re.exec(F),J=H&&K.parse(H),G=K.space||"rgba";if(J){if(G==="hsla"){E.value=B.RGBtoHSB.apply(null,B.HSLtoRGB.apply(null,J))}else{E.value=B.RGBtoHSB.apply(null,J)}return false}})},setHue:function(E){this.value.h=1-E},setSaturation:function(E){this.value.s=E},setLightness:function(E){this.value.b=1-E},setAlpha:function(E){this.value.a=parseInt((1-E)*100,10)/100},toRGB:function(N,L,K,J){if(!N){N=this.value.h;L=this.value.s;K=this.value.b}N*=360;var I,H,E,M,F;N=(N%360)/60;F=K*L;M=F*(1-Math.abs(N%2-1));I=H=E=K-F;N=~~N;I+=[F,M,0,0,M,F][N];H+=[M,F,F,M,0,0][N];E+=[0,0,M,F,F,M][N];return{r:Math.round(I*255),g:Math.round(H*255),b:Math.round(E*255),a:J||this.value.a}},toHex:function(H,E,G,F){var I=this.toRGB(H,E,G,F);return"#"+((1<<24)|(parseInt(I.r)<<16)|(parseInt(I.g)<<8)|parseInt(I.b)).toString(16).substr(1)},toHSL:function(K,F,J,I){if(!K){K=this.value.h;F=this.value.s;J=this.value.b}var M=K,E=(2-F)*J,G=F*J;if(E>0&&E<=1){G/=E}else{G/=2-E}E/=2;if(G>1){G=1}return{h:M,s:G,l:E,a:I||this.value.a}}};var A=function(F,G){this.element=C(F);var E=G.format||this.element.data("color-format")||"hex";this.format=B.translateFormats[E];this.isInput=this.element.is("input");this.component=this.element.is(".color")?this.element.find(".add-on"):false;this.picker=C(B.template).appendTo("body").on("mousedown",C.proxy(this.mousedown,this));if(this.isInput){this.element.on({"focus":C.proxy(this.show,this),"keyup":C.proxy(this.update,this)})}else{if(this.component){this.component.on({"click":C.proxy(this.show,this)})}else{this.element.on({"click":C.proxy(this.show,this)})}}if(E==="rgba"||E==="hsla"){this.picker.addClass("alpha");this.alpha=this.picker.find(".colorpicker-alpha")[0].style}if(this.component){this.picker.find(".colorpicker-color").hide();this.preview=this.element.find("i")[0].style}else{this.preview=this.picker.find("div:last")[0].style}this.base=this.picker.find("div:first")[0].style;this.update()};A.prototype={constructor:A,show:function(E){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();C(window).on("resize",C.proxy(this.place,this));if(!this.isInput){if(E){E.stopPropagation();E.preventDefault()}}C(document).on({"mousedown":C.proxy(this.hide,this)});this.element.trigger({type:"show",color:this.color})},update:function(){this.color=new D(this.isInput?this.element.prop("value"):this.element.data("color"));this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor()},setValue:function(E){this.color=new D(E);this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor();this.element.trigger({type:"changeColor",color:this.color})},hide:function(){this.picker.hide();C(window).off("resize",this.place);if(!this.isInput){C(document).off({"mousedown":this.hide});if(this.component){this.element.find("input").prop("value",this.format.call(this))}this.element.data("color",this.format.call(this))}else{this.element.prop("value",this.format.call(this))}this.element.trigger({type:"hide",color:this.color})},place:function(){var E=this.component?this.component.offset():this.element.offset();this.picker.css({top:E.top+this.height,left:E.left})},previewColor:function(){try{this.preview.backgroundColor=this.format.call(this)}catch(E){this.preview.backgroundColor=this.color.toHex()}this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1);if(this.alpha){this.alpha.backgroundColor=this.color.toHex()}},pointer:null,slider:null,mousedown:function(G){G.stopPropagation();G.preventDefault();var E=C(G.target);var H=E.closest("div");if(!H.is(".colorpicker")){if(H.is(".colorpicker-saturation")){this.slider=C.extend({},B.sliders.saturation)}else{if(H.is(".colorpicker-hue")){this.slider=C.extend({},B.sliders.hue)}else{if(H.is(".colorpicker-alpha")){this.slider=C.extend({},B.sliders.alpha)}else{return false}}}var F=H.offset();this.slider.knob=H.find("i")[0].style;this.slider.left=G.pageX-F.left;this.slider.top=G.pageY-F.top;this.pointer={left:G.pageX,top:G.pageY};C(document).on({mousemove:C.proxy(this.mousemove,this),mouseup:C.proxy(this.mouseup,this)}).trigger("mousemove")}return false},mousemove:function(G){G.stopPropagation();G.preventDefault();var F=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((G.pageX||this.pointer.left)-this.pointer.left)));var E=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((G.pageY||this.pointer.top)-this.pointer.top)));this.slider.knob.left=F+"px";this.slider.knob.top=E+"px";if(this.slider.callLeft){this.color[this.slider.callLeft].call(this.color,F/100)}if(this.slider.callTop){this.color[this.slider.callTop].call(this.color,E/100)}this.previewColor();this.element.trigger({type:"changeColor",color:this.color});return false},mouseup:function(E){E.stopPropagation();E.preventDefault();C(document).off({mousemove:this.mousemove,mouseup:this.mouseup});return false}};C.fn.colorpicker=function(E,F){return this.each(function(){var H=C(this),I=H.data("colorpicker"),G=typeof E==="object"&&E;if(!I){H.data("colorpicker",(I=new A(this,C.extend({},C.fn.colorpicker.defaults,G))))}if(typeof E==="string"){I[E](F)}})};C.fn.colorpicker.defaults={};C.fn.colorpicker.Constructor=A;var B={translateFormats:{"rgb":function(){var E=this.color.toRGB();return"rgb("+E.r+","+E.g+","+E.b+")"},"rgba":function(){var E=this.color.toRGB();return"rgba("+E.r+","+E.g+","+E.b+","+E.a+")"},"hsl":function(){var E=this.color.toHSL();return"hsl("+Math.round(E.h*360)+","+Math.round(E.s*100)+"%,"+Math.round(E.l*100)+"%)"},"hsla":function(){var E=this.color.toHSL();return"hsla("+Math.round(E.h*360)+","+Math.round(E.s*100)+"%,"+Math.round(E.l*100)+"%,"+E.a+")"},"hex":function(){return this.color.toHex()}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},hue:{maxLeft:0,maxTop:100,callLeft:false,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:false,callTop:"setAlpha"}},RGBtoHSB:function(L,K,G,F){L/=255;K/=255;G/=255;var J,E,I,M;I=Math.max(L,K,G);M=I-Math.min(L,K,G);J=(M===0?null:I==L?(K-G)/M:I==K?(G-L)/M+2:(L-K)/M+4);J=((J+360)%6)*60/360;E=M===0?0:M/I;return{h:J||1,s:E,b:I,a:F||1}},HueToRGB:function(F,G,E){if(E<0){E+=1}else{if(E>1){E-=1}}if((E*6)<1){return F+(G-F)*E*6}else{if((E*2)<1){return G}else{if((E*3)<2){return F+(G-F)*((2/3)-E)*6}else{return F}}}},HSLtoRGB:function(P,N,G,I){if(N<0){N=0}var L;if(G<=0.5){L=G*(1+N)}else{L=G+N-(G*N)}var K=2*G-L;var O=P+(1/3);var E=P;var F=P-(1/3);var M=Math.round(B.HueToRGB(K,L,O)*255);var J=Math.round(B.HueToRGB(K,L,E)*255);var H=Math.round(B.HueToRGB(K,L,F)*255);return[M,J,H,I||1]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(E){return[E[1],E[2],E[3],E[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(E){return[2.55*E[1],2.55*E[2],2.55*E[3],E[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(E){return[parseInt(E[1],16),parseInt(E[2],16),parseInt(E[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(E){return[parseInt(E[1]+E[1],16),parseInt(E[2]+E[2],16),parseInt(E[3]+E[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(E){return[E[1]/360,E[2]/100,E[3]/100,E[4]]}}],template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div></div>'}}(window.jQuery);