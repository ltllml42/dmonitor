(function(B,A,C){if(typeof define==="function"&&define.amd){define(["jquery"],function(D){C(D,B,A);return D.mobile})}else{C(B.jQuery,B,A)}}(this,document,function(A,B,C,D){(function(J,H,g,F){var P="virtualMouseBindings",s="virtualTouchID",T="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),f="clientX clientY pageX pageY screenX screenY".split(" "),E=J.event.mouseHooks?J.event.mouseHooks.props:[],p=J.event.props.concat(E),G={},a=0,M=0,n=0,R=false,I=[],U=false,X=false,c="addEventListener" in g,b=J(g),m=1,W=0,e,Z;J.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};function O(i){while(i&&typeof i.originalEvent!=="undefined"){i=i.originalEvent}return i}function V(Ac,Ab){var Ah=Ac.type,Ag,Ae,Af,z,Aa,Ad,w,x,y;Ac=J.Event(Ac);Ac.type=Ab;Ag=Ac.originalEvent;Ae=J.event.props;if(Ah.search(/^(mouse|click)/)>-1){Ae=p}if(Ag){for(w=Ae.length,z;w;){z=Ae[--w];Ac[z]=Ag[z]}}if(Ah.search(/mouse(down|up)|click/)>-1&&!Ac.which){Ac.which=1}if(Ah.search(/^touch/)!==-1){Af=O(Ag);Ah=Af.touches;Aa=Af.changedTouches;Ad=(Ah&&Ah.length)?Ah[0]:((Aa&&Aa.length)?Aa[0]:F);if(Ad){for(x=0,y=f.length;x<y;x++){z=f[x];Ac[z]=Ad[z]}}}return Ac}function Y(w){var y={},i,x;while(w){i=J.data(w,P);for(x in i){if(i[x]){y[x]=y.hasVirtualBinding=true}}w=w.parentNode}return y}function u(x,w){var i;while(x){i=J.data(x,P);if(i&&(!w||i[w])){return x}x=x.parentNode}return null}function k(){X=false}function t(){X=true}function q(){W=0;I.length=0;U=false;t()}function r(){k()}function l(){d();a=setTimeout(function(){a=0;q()},J.vmouse.resetTimerDuration)}function d(){if(a){clearTimeout(a);a=0}}function Q(w,y,x){var i;if((x&&x[w])||(!x&&u(y.target,w))){i=V(y,w);J(y.target).trigger(i)}return i}function K(x){var i=J.data(x.target,s),w;if(!U&&(!W||W!==i)){w=Q("v"+x.type,x);if(w){if(w.isDefaultPrevented()){x.preventDefault()}if(w.isPropagationStopped()){x.stopPropagation()}if(w.isImmediatePropagationStopped()){x.stopImmediatePropagation()}}}}function S(w){var y=O(w).touches,z,x,i;if(y&&y.length===1){z=w.target;x=Y(z);if(x.hasVirtualBinding){W=m++;J.data(z,s,W);d();r();R=false;i=O(w).touches[0];M=i.pageX;n=i.pageY;Q("vmouseover",w,x);Q("vmousedown",w,x)}}}function o(i){if(X){return}if(!R){Q("vmousecancel",i,Y(i.target))}R=true;l()}function v(x){if(X){return}var i=O(x).touches[0],y=R,w=J.vmouse.moveDistanceThreshold,z=Y(x.target);R=R||(Math.abs(i.pageX-M)>w||Math.abs(i.pageY-n)>w);if(R&&!y){Q("vmousecancel",x,z)}Q("vmousemove",x,z);l()}function N(x){if(X){return}t();var y=Y(x.target),w,i;Q("vmouseup",x,y);if(!R){w=Q("vclick",x,y);if(w&&w.isDefaultPrevented()){i=O(x).changedTouches[0];I.push({touchID:W,x:i.clientX,y:i.clientY});U=true}}Q("vmouseout",x,y);R=false;l()}function L(i){var w=J.data(i,P),x;if(w){for(x in w){if(w[x]){return true}}}return false}function j(){}function h(w){var i=w.substr(1);return{setup:function(){if(!L(this)){J.data(this,P,{})}var x=J.data(this,P);x[w]=true;G[w]=(G[w]||0)+1;if(G[w]===1){b.bind(i,K)}J(this).bind(i,j);if(c){G["touchstart"]=(G["touchstart"]||0)+1;if(G["touchstart"]===1){b.bind("touchstart",S).bind("touchend",N).bind("touchmove",v).bind("scroll",o)}}},teardown:function(){--G[w];if(!G[w]){b.unbind(i,K)}if(c){--G["touchstart"];if(!G["touchstart"]){b.unbind("touchstart",S).unbind("touchmove",v).unbind("touchend",N).unbind("scroll",o)}}var y=J(this),x=J.data(this,P);if(x){x[w]=false}y.unbind(i,j);if(!L(this)){y.removeData(P)}}}}for(Z=0;Z<T.length;Z++){J.event.special[T[Z]]=h(T[Z])}if(c){g.addEventListener("click",function(Ad){var z=I.length,Ag=Ad.target,Af,Ab,Aa,w,Ac,Ae;if(z){Af=Ad.clientX;Ab=Ad.clientY;e=J.vmouse.clickDistanceThreshold;Aa=Ag;while(Aa){for(w=0;w<z;w++){Ac=I[w];Ae=0;if((Aa===Ag&&Math.abs(Ac.x-Af)<e&&Math.abs(Ac.y-Ab)<e)||J.data(Aa,s)===Ac.touchID){Ad.preventDefault();Ad.stopPropagation();return}}Aa=Aa.parentNode}}},true)}})(A,B,C);(function(E){E.mobile={}}(A));(function(E,G){var F={touch:"ontouchend" in C};E.mobile.support=E.mobile.support||{};E.extend(E.support,F);E.extend(E.mobile.support,F)}(A));(function(I,M,G){var K=I(C),L=I.mobile.support.touch,E="touchmove scroll",J=L?"touchstart":"mousedown",F=L?"touchend":"mouseup",N=L?"touchmove":"mousemove";I.each(("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop").split(" "),function(P,O){I.fn[O]=function(Q){return Q?this.bind(O,Q):this.trigger(O)};if(I.attrFn){I.attrFn[O]=true}});function H(S,Q,P,O){var R=P.type;P.type=Q;if(O){I.event.trigger(P,G,S)}else{I.event.dispatch.call(S,P)}P.type=R}I.event.special.scrollstart={enabled:true,setup:function(){var O=this,R=I(O),P,Q;function S(U,T){P=T;H(O,P?"scrollstart":"scrollstop",U)}R.bind(E,function(T){if(!I.event.special.scrollstart.enabled){return}if(!P){S(T,true)}clearTimeout(Q);Q=setTimeout(function(){S(T,false)},50)})},teardown:function(){I(this).unbind(E)}};I.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:true,setup:function(){var O=this,Q=I(O),P=false;Q.bind("vmousedown",function(S){P=false;if(S.which&&S.which!==1){return false}var W=S.target,T;function U(){clearTimeout(T)}function R(){U();Q.unbind("vclick",V).unbind("vmouseup",U);K.unbind("vmousecancel",R)}function V(X){R();if(!P&&W===X.target){H(O,"tap",X)}else{if(P){X.preventDefault()}}}Q.bind("vmouseup",U).bind("vclick",V);K.bind("vmousecancel",R);T=setTimeout(function(){if(!I.event.special.tap.emitTapOnTaphold){P=true}H(O,"taphold",I.Event("taphold",{target:W}))},I.event.special.tap.tapholdThreshold)})},teardown:function(){I(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup");K.unbind("vmousecancel")}};I.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1000,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(Q){var R=M.pageXOffset,S=M.pageYOffset,O=Q.clientX,P=Q.clientY;if(Q.pageY===0&&Math.floor(P)>Math.floor(Q.pageY)||Q.pageX===0&&Math.floor(O)>Math.floor(Q.pageX)){O=O-R;P=P-S}else{if(P<(Q.pageY-S)||O<(Q.pageX-R)){O=Q.pageX-R;P=Q.pageY-S}}return{x:O,y:P}},start:function(P){var Q=P.originalEvent.touches?P.originalEvent.touches[0]:P,O=I.event.special.swipe.getLocation(Q);return{time:(new Date()).getTime(),coords:[O.x,O.y],origin:I(P.target)}},stop:function(P){var Q=P.originalEvent.touches?P.originalEvent.touches[0]:P,O=I.event.special.swipe.getLocation(Q);return{time:(new Date()).getTime(),coords:[O.x,O.y]}},handleSwipe:function(P,R,O,S){if(R.time-P.time<I.event.special.swipe.durationThreshold&&Math.abs(P.coords[0]-R.coords[0])>I.event.special.swipe.horizontalDistanceThreshold&&Math.abs(P.coords[1]-R.coords[1])<I.event.special.swipe.verticalDistanceThreshold){var Q=P.coords[0]>R.coords[0]?"swipeleft":"swiperight";H(O,"swipe",I.Event("swipe",{target:S,swipestart:P,swipestop:R}),true);H(O,Q,I.Event(Q,{target:S,swipestart:P,swipestop:R}),true);return true}return false},eventInProgress:false,setup:function(){var Q,O=this,R=I(O),P={};Q=I.data(this,"mobile-events");if(!Q){Q={length:0};I.data(this,"mobile-events",Q)}Q.length++;Q.swipe=P;P.start=function(T){if(I.event.special.swipe.eventInProgress){return}I.event.special.swipe.eventInProgress=true;var V,S=I.event.special.swipe.start(T),W=T.target,U=false;P.move=function(X){if(!S||X.isDefaultPrevented()){return}V=I.event.special.swipe.stop(X);if(!U){U=I.event.special.swipe.handleSwipe(S,V,O,W);if(U){I.event.special.swipe.eventInProgress=false}}if(Math.abs(S.coords[0]-V.coords[0])>I.event.special.swipe.scrollSupressionThreshold){X.preventDefault()}};P.stop=function(){U=true;I.event.special.swipe.eventInProgress=false;K.off(N,P.move);P.move=null};K.on(N,P.move).one(F,P.stop)};R.on(J,P.start)},teardown:function(){var O,P;O=I.data(this,"mobile-events");if(O){P=O.swipe;delete O.swipe;O.length--;if(O.length===0){I.removeData(this,"mobile-events")}}if(P){if(P.start){I(this).off(J,P.start)}if(P.move){K.off(N,P.move)}if(P.stop){K.off(F,P.stop)}}}};I.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(P,O){I.event.special[P]={setup:function(){I(this).bind(O,I.noop)},teardown:function(){I(this).unbind(O)}}})})(A,this)}));