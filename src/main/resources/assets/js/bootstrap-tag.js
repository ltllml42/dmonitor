!function(C){var A=function(D,E){this.element=C(D);this.options=C.extend(true,{},C.fn.tag.defaults,E);this.values=C.grep(C.map(this.element.val().split(","),C.trim),function(F){return F.length>0});this.show()};A.prototype={constructor:A,show:function(){var D=this;D.element.parent().prepend(D.element.detach().hide());D.element.wrap(C('<div class="tags">')).parent().on("click",function(){D.input.focus()});if(D.values.length){C.each(D.values,function(){D.createBadge(this)})}D.input=C('<input type="text">').attr("placeholder",D.options.placeholder).insertAfter(D.element).on("focus",function(){D.element.parent().addClass("tags-hover")}).on("blur",function(){if(!D.skip){D.process();D.element.parent().removeClass("tags-hover");D.element.siblings(".tag").removeClass("tag-important")}D.skip=false}).on("keydown",function(G){if(G.keyCode==188||G.keyCode==13||G.keyCode==9){if(C.trim(C(this).val())&&(!D.element.siblings(".typeahead").length||D.element.siblings(".typeahead").is(":hidden"))){if(G.keyCode!=9){G.preventDefault()}D.process()}else{if(G.keyCode==188){if(!D.element.siblings(".typeahead").length||D.element.siblings(".typeahead").is(":hidden")){G.preventDefault()}else{D.input.data("typeahead").select();G.stopPropagation();G.preventDefault()}}}}else{if(!C.trim(C(this).val())&&G.keyCode==8){var E=D.element.siblings(".tag").length;if(E){var F=D.element.siblings(".tag:eq("+(E-1)+")");if(F.hasClass("tag-important")){D.remove(E-1)}else{F.addClass("tag-important")}}}else{D.element.siblings(".tag").removeClass("tag-important")}}}).bs_typeahead({source:D.options.source,matcher:function(E){return ~E.toLowerCase().indexOf(this.query.toLowerCase())&&(D.inValues(E)==-1||D.options.allowDuplicates)},updater:C.proxy(D.add,D)});C(D.input.data("bs_typeahead").$menu).on("mousedown",function(){D.skip=true});this.element.trigger("shown")},inValues:function(D){if(this.options.caseInsensitive){var E=-1;C.each(this.values,function(G,F){if(F.toLowerCase()==D.toLowerCase()){E=G;return false}});return E}else{return C.inArray(D,this.values)}},createBadge:function(D){var E=this;C("<span/>",{"class":"tag"}).text(D).append(C('<button type="button" class="close">&times;</button>').on("click",function(){E.remove(E.element.siblings(".tag").index(C(this).closest(".tag")))})).insertBefore(E.element)},add:function(E){var F=this;if(!F.options.allowDuplicates){var G=F.inValues(E);if(G!=-1){var D=F.element.siblings(".tag:eq("+G+")");D.addClass("tag-warning");setTimeout(function(){C(D).removeClass("tag-warning")},500);return}}this.values.push(E);this.createBadge(E);this.element.val(this.values.join(", "));this.element.trigger("added",[E])},remove:function(E){if(E>=0){var D=this.values.splice(E,1);this.element.siblings(".tag:eq("+E+")").remove();this.element.val(this.values.join(", "));this.element.trigger("removed",[D])}},process:function(){var E=C.grep(C.map(this.input.val().split(","),C.trim),function(F){return F.length>0}),D=this;C.each(E,function(){D.add(this)});this.input.val("")},skip:false};var B=C.fn.tag;C.fn.tag=function(D){return this.each(function(){var E=C(this),G=E.data("tag"),F=typeof D=="object"&&D;if(!G){E.data("tag",(G=new A(this,F)))}if(typeof D=="string"){G[D]()}})};C.fn.tag.defaults={allowDuplicates:false,caseInsensitive:true,placeholder:"",source:[]};C.fn.tag.Constructor=A;C.fn.tag.noConflict=function(){C.fn.tag=B;return this};C(window).on("load",function(){C('[data-provide="tag"]').each(function(){var D=C(this);if(D.data("tag")){return}D.tag(D.data())})})}(window.jQuery);