!function(A){"function"==typeof define&&define.amd?define(["jquery"],A):A("object"==typeof exports?require("jquery"):jQuery)}(function(C){var B,F=navigator.userAgent,D=/iphone/i.test(F),E=/chrome/i.test(F),A=/android/i.test(F);C.mask={definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},C.fn.extend({caret:function(H,I){var G;if(0!==this.length&&!this.is(":hidden")){return"number"==typeof H?(I="number"==typeof I?I:H,this.each(function(){this.setSelectionRange?this.setSelectionRange(H,I):this.createTextRange&&(G=this.createTextRange(),G.collapse(!0),G.moveEnd("character",I),G.moveStart("character",H),G.select())})):(this[0].setSelectionRange?(H=this[0].selectionStart,I=this[0].selectionEnd):document.selection&&document.selection.createRange&&(G=document.selection.createRange(),H=0-G.duplicate().moveStart("character",-100000),I=H+G.text.length),{begin:H,end:I})}},unmask:function(){return this.trigger("unmask")},mask:function(P,I){var L,Q,M,J,O,G,N,K;if(!P&&this.length>0){L=C(this[0]);var H=L.data(C.mask.dataName);return H?H():void 0}return I=C.extend({autoclear:C.mask.autoclear,placeholder:C.mask.placeholder,completed:null},I),Q=C.mask.definitions,M=[],J=N=P.length,O=null,C.each(P.split(""),function(S,R){"?"==R?(N--,J=S):Q[R]?(M.push(new RegExp(Q[R])),null===O&&(O=M.length-1),J>S&&(G=M.length-1)):M.push(null)}),this.trigger("unmask").each(function(){function W(){if(I.completed){for(var j=O;G>=j;j++){if(M[j]&&d[j]===Z(j)){return}}I.completed.call(e)}}function Z(j){return I.placeholder.charAt(j<I.placeholder.length?j:0)}function S(i){for(;++i<N&&!M[i];){}return i}function V(i){for(;--i>=0&&!M[i];){}return i}function X(k,l){var m,n;if(!(0>k)){for(m=k,n=S(l);N>m;m++){if(M[m]){if(!(N>n&&M[m].test(d[n]))){break}d[m]=d[n],d[n]=Z(n),n=S(n)}}g(),e.caret(Math.max(O,k))}}function b(l){var n,m,o,k;for(n=l,m=Z(l);N>n;n++){if(M[n]){if(o=S(n),k=d[n],d[n]=m,!(N>o&&M[o].test(k))){break}m=k}}}function a(){var j=e.val(),i=e.caret();if(j.length<K.length){for(U(!0);i.begin>0&&!M[i.begin-1];){i.begin--}if(0===i.begin){for(;i.begin<O&&!M[i.begin];){i.begin++}}e.caret(i.begin,i.begin)}else{for(U(!0);i.begin<N&&!M[i.begin];){i.begin++}e.caret(i.begin,i.begin)}W()}function h(){U(),e.val()!=f&&e.change()}function T(m){if(!e.prop("readonly")){var i,l,j,n=m.which||m.keyCode;K=e.val(),8===n||46===n||D&&127===n?(i=e.caret(),l=i.begin,j=i.end,j-l===0&&(l=46!==n?V(l):j=S(l-1),j=46===n?S(j):j),c(l,j),X(l,j-1),m.preventDefault()):13===n?h.call(this,m):27===n&&(e.val(f),e.caret(0,U()),m.preventDefault())}}function Y(o){if(!e.prop("readonly")){var q,m,j,l=o.which||o.keyCode,i=e.caret();if(!(o.ctrlKey||o.altKey||o.metaKey||32>l)&&l&&13!==l){if(i.end-i.begin!==0&&(c(i.begin,i.end),X(i.begin,i.end-1)),q=S(i.begin-1),N>q&&(m=String.fromCharCode(l),M[q].test(m))){if(b(q),d[q]=m,g(),j=S(q),A){var n=function(){C.proxy(C.fn.caret,e,j)()};setTimeout(n,0)}else{e.caret(j)}i.begin<=G&&W()}o.preventDefault()}}}function c(j,k){var l;for(l=j;k>l&&N>l;l++){M[l]&&(d[l]=Z(l))}}function g(){e.val(d.join(""))}function U(k){var n,m,l,j=e.val(),o=-1;for(n=0,l=0;N>n;n++){if(M[n]){for(d[n]=Z(n);l++<j.length;){if(m=j.charAt(l-1),M[n].test(m)){d[n]=m,o=n;break}}if(l>j.length){c(n+1,N);break}}else{d[n]===j.charAt(l)&&l++,J>n&&(o=n)}}return k?g():J>o+1?I.autoclear||d.join("")===R?(e.val()&&e.val(""),c(0,N)):g():(g(),e.val(e.val().substring(0,o+1))),J?n:O}var e=C(this),d=C.map(P.split(""),function(j,k){return"?"!=j?Q[j]?Z(k):j:void 0}),R=d.join(""),f=e.val();e.data(C.mask.dataName,function(){return C.map(d,function(j,k){return M[k]&&j!=Z(k)?j:null}).join("")}),e.one("unmask",function(){e.off(".mask").removeData(C.mask.dataName)}).on("focus.mask",function(){if(!e.prop("readonly")){clearTimeout(B);var i;f=e.val(),i=U(),B=setTimeout(function(){g(),i==P.replace("?","").length?e.caret(0,i):e.caret(i)},10)}}).on("blur.mask",h).on("keydown.mask",T).on("keypress.mask",Y).on("input.mask paste.mask",function(){e.prop("readonly")||setTimeout(function(){var i=U(!0);e.caret(i),W()},0)}),E&&A&&e.off("input.mask").on("input.mask",a),U()})}})});